# ðŸŽµ EchoTune AI - API Documentation

## Overview

EchoTune AI provides a comprehensive REST API for music recommendation and Spotify integration. This documentation covers all available endpoints, authentication methods, and usage examples.

## Base URL
```
Production: https://your-domain.com/api
Development: http://localhost:3000/api
```

## Authentication

### Spotify OAuth 2.0
All API endpoints require valid Spotify authentication tokens.

```javascript
// Authorization header
Authorization: Bearer {spotify_access_token}
```

## Core Endpoints

### ðŸŽ§ Music Recommendations

#### GET /recommendations
Get personalized music recommendations for a user.

**Parameters:**
- `limit` (integer, optional): Number of recommendations (default: 20, max: 100)
- `seed_artists` (string, optional): Comma-separated artist IDs
- `seed_genres` (string, optional): Comma-separated genre names
- `seed_tracks` (string, optional): Comma-separated track IDs

**Response:**
```json
{
  "tracks": [
    {
      "id": "4iV5W9uYEdYUVa79Axb7Rh",
      "name": "Song Name",
      "artists": [{"name": "Artist Name", "id": "artist_id"}],
      "album": {"name": "Album Name", "images": [...]},
      "audio_features": {
        "danceability": 0.735,
        "energy": 0.578,
        "valence": 0.624
      },
      "recommendation_score": 0.89,
      "recommendation_reason": "Based on your recent listening habits"
    }
  ],
  "meta": {
    "total": 20,
    "generated_at": "2024-01-20T10:30:00Z",
    "algorithm": "collaborative_filtering_v2"
  }
}
```

#### POST /recommendations/feedback
Provide feedback on recommendations to improve future suggestions.

**Request Body:**
```json
{
  "track_id": "4iV5W9uYEdYUVa79Axb7Rh",
  "feedback": "like|dislike|love|skip",
  "context": "workout|study|commute|party"
}
```

### ðŸ¤– AI Chat Interface

#### POST /chat/message
Send a message to the AI music assistant.

**Request Body:**
```json
{
  "message": "I want some energetic workout music",
  "context": {
    "time_of_day": "morning",
    "current_mood": "motivated",
    "recent_tracks": ["track_id_1", "track_id_2"]
  }
}
```

**Response:**
```json
{
  "response": "Here are some high-energy tracks perfect for your workout...",
  "tracks": [...],
  "intent": {
    "activity": "workout",
    "mood": "energetic",
    "confidence": 0.95
  },
  "conversation_id": "conv_123"
}
```

### ðŸ“Š User Analytics

#### GET /user/listening-history
Retrieve user's listening history and analytics.

**Parameters:**
- `limit` (integer): Number of tracks (default: 50, max: 1000)
- `time_range` (string): "short_term", "medium_term", or "long_term"
- `after` (string, ISO date): Get tracks after this date

#### GET /user/top-genres
Get user's top genres based on listening history.

**Response:**
```json
{
  "genres": [
    {
      "name": "electronic",
      "play_count": 245,
      "percentage": 34.2,
      "representative_tracks": [...]
    }
  ],
  "analysis_period": "medium_term",
  "total_tracks_analyzed": 716
}
```

### ðŸ”„ Playlist Management

#### POST /playlists/generate
Generate a smart playlist based on criteria.

**Request Body:**
```json
{
  "name": "My AI Workout Mix",
  "description": "Generated by EchoTune AI",
  "criteria": {
    "energy_min": 0.7,
    "danceability_min": 0.6,
    "duration_ms": 3600000,
    "include_genres": ["electronic", "pop"],
    "exclude_artists": ["artist_id_to_exclude"]
  },
  "create_spotify_playlist": true
}
```

## Error Handling

### HTTP Status Codes
- `200` - Success
- `400` - Bad Request (invalid parameters)
- `401` - Unauthorized (invalid/expired token)
- `403` - Forbidden (insufficient permissions)
- `404` - Not Found
- `429` - Rate Limited
- `500` - Internal Server Error

### Error Response Format
```json
{
  "error": {
    "code": "INVALID_TOKEN",
    "message": "The provided access token is invalid or expired",
    "details": {
      "timestamp": "2024-01-20T10:30:00Z",
      "request_id": "req_abc123"
    }
  }
}
```

## Rate Limiting

API endpoints are rate limited to ensure fair usage:
- **General endpoints**: 100 requests per 15 minutes per user
- **Recommendation endpoints**: 50 requests per hour per user
- **Chat endpoints**: 20 messages per minute per user

Rate limit headers are included in responses:
```
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 85
X-RateLimit-Reset: 1642680600
```

## SDKs and Examples

### JavaScript/Node.js
```javascript
const EchoTuneAPI = require('@echotune/api-client');

const client = new EchoTuneAPI({
  accessToken: 'your_spotify_token',
  baseURL: 'https://your-domain.com/api'
});

// Get recommendations
const recommendations = await client.recommendations.get({
  limit: 10,
  seed_genres: 'electronic,ambient'
});

// Send chat message
const response = await client.chat.sendMessage(
  "Play something chill for studying"
);
```

### Python
```python
from echotune_api import EchoTuneClient

client = EchoTuneClient(
    access_token='your_spotify_token',
    base_url='https://your-domain.com/api'
)

# Get recommendations
recommendations = client.recommendations.get(
    limit=10,
    seed_genres=['electronic', 'ambient']
)

# Send chat message
response = client.chat.send_message(
    "Play something chill for studying"
)
```

## Webhooks

### Playlist Updates
Receive notifications when AI-generated playlists are updated.

**Endpoint Setup:**
```
POST /webhooks/register
{
  "url": "https://your-app.com/webhook",
  "events": ["playlist.updated", "recommendations.generated"],
  "": "your_webhook_secret"
}
```

## Support

- **Documentation**: [GitHub Repository](https://github.com/dzp5103/Spotify-echo)
- **Issues**: [Report bugs](https://github.com/dzp5103/Spotify-echo/issues)
- **Discord**: [Community Support](#)

---

**Last Updated**: January 2024
**API Version**: v1.0
